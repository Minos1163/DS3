{
  "dry_run": false,
  "trading": {
    "symbols": [
      "BTCUSDT",
      "ETHUSDT",
      "BNBUSDT",
      "XRPUSDT",
      "ADAUSDT",
      "DOGEUSDT",
      "SOLUSDT",
      "TRXUSDT",
      "DOTUSDT",
      "LTCUSDT"
    ],
    "default_leverage": 10,
    "max_leverage": 100,
    "min_position_percent": 5,
    "max_position_percent": 50,
    "reserve_percent": 20,
    "max_stop_loss_abs": 1.2
  },
  "risk": {
    "initial_margin": 4.2,
    "max_positions": 3,
    "max_long_positions": 3,
    "max_short_positions": 3,
    "max_position_pct": 0.3,
    "total_stop_loss_pct": 0.25,
    "max_daily_loss_percent": 10,
    "max_consecutive_losses": 3,
    "stop_loss_default_percent": 0.006,
    "take_profit_default_percent": 0.14,
    "use_atr_stop_loss": true,
    "atr_multiplier": 3.0,
    "atr_timeframe": "1h",
    "oscillation": {
      "entry_gate": {
        "min_p_win_long": 0.48,
        "min_p_win_short": 0.46,
        "min_score_long": 0.1,
        "max_score_short": 0.005
      },
      "exit": {
        "take_profit_pct": 0.007,
        "symbol_stop_loss_pct": 0.008,
        "break_even_trigger_pct": 0.002,
        "trailing_stop_trigger_pct": 0.005,
        "trailing_stop_pct": 0.002
      },
      "take_profit_ratio": {
        "RANGE": 0.55,
        "RANGE_LOCK": 0.35
      },
      "stop_loss_ratio": {
        "RANGE": 0.85,
        "RANGE_LOCK": 0.7
      },
      "break_even_trigger_ratio": {
        "RANGE": 0.8,
        "RANGE_LOCK": 0.65
      },
      "trailing_trigger_ratio": {
        "RANGE": 0.85,
        "RANGE_LOCK": 0.7
      },
      "trailing_stop_ratio": {
        "RANGE": 0.9,
        "RANGE_LOCK": 0.8
      },
      "trailing_stop_after_be_ratio": {
        "RANGE": 1.15,
        "RANGE_LOCK": 1.3
      }
    },
    "trend": {
      "entry": {
        "pullback_rsi_max": 55,
        "pullback_bb_mid_max": 0.002,
        "breakout_bb_width_min": 0.03,
        "min_ts_asset": 0.35,
        "min_p_win": 0.42
      },
      "exit": {
        "take_profit_pct": 0.045,
        "symbol_stop_loss_pct": 0.012,
        "break_even_trigger_pct": 0.01,
        "trailing_stop_trigger_pct": 0.02,
        "trailing_stop_pct": 0.01,
        "max_hold_bars": 360
      }
    }
  },
  "monitoring": {
    "unrealized_pnl_threshold_usdt": 0.05
  },
  "strategy": {
    "mode": "DUAL_ENGINE",
    "version": "V5",
    "interval": "5m",
    "position_percent": 0.45,
    "leverage": 10,
    "stop_loss_percent": 0.006,
    "take_profit_percent": 0.14,
    "rsi_oversold": 18,
    "rsi_overbought": 78,
    "short_rsi_overbought": 64,
    "ema_fast": 5,
    "ema_slow": 20,
    "ma_trend": 20,
    "bb_window": 20,
    "bb_std": 2,
    "macd_fast": 12,
    "macd_slow": 26,
    "macd_signal": 9,
    "volume_multiplier": 1.1,
    "use_volume_quantile_filter": true,
    "volume_quantile": 0.3,
    "short_volume_quantile": 0.45,
    "volume_window": 60,
    "use_time_filter": false,
    "allowed_hours_utc": [
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15,
      16,
      17,
      18,
      19,
      20,
      21,
      22,
      23
    ],
    "max_hold_bars": 60,
    "cooldown_bars": 12,
    "max_consecutive_losses": 3,
    "dca_enabled": false,
    "trend_filter_enabled": true,
    "trend_timeframe": "4h",
    "trend_ema_fast": 20,
    "trend_ema_slow": 50,
    "bull_long_rsi_adjust": 2,
    "bull_short_rsi_adjust": 2,
    "bear_long_rsi_adjust": -4,
    "bear_short_rsi_adjust": -4,
    "regime_extra_filter_enabled": true
  },
  "ai": {
    "model": "deepseek-reasoner",
    "temperature": 0.7,
    "max_tokens": 2000,
    "enabled": false,
    "dca_gate": false,
    "dca_open_gate": false,
    "dca_close_gate": false,
    "dca_top_n": 3,
    "dca_min_confidence": 0.4,
    "dca_fail_policy": "ALLOW",
    "allow_force_min_position": true
  },
  "schedule": {
    "interval_seconds": 300,
    "retry_times": 3,
    "retry_delay_seconds": 20,
    "download_delay_seconds": 5
  },
  "dca_rotation": {
    "config_tag": "dual_engine_range_trend_live_20260214",
    "symbols": [
      "BTCUSDT",
      "ETHUSDT",
      "BNBUSDT",
      "SOLUSDT",
      "XRPUSDT",
      "DOGEUSDT",
      "ADAUSDT",
      "TRXUSDT",
      "AVAXUSDT",
      "LINKUSDT",
      "SHIBUSDT",
      "DOTUSDT",
      "LTCUSDT",
      "NEARUSDT",
      "BCHUSDT",
      "UNIUSDT",
      "APTUSDT",
      "ARBUSDT",
      "OPUSDT",
      "ATOMUSDT",
      "SUIUSDT",
      "HBARUSDT",
      "1000PEPEUSDT",
      "1000SHIBUSDT",
      "BONKUSDT",
      "FLOKIUSDT",
      "WIFUSDT",
      "BOMEUSDT",
      "MEMEUSDT"
    ],
    "interval": "5m",
    "account": "H52",
    "force_close_unknown_symbols": true,
    "force_close_non_short": false,
    "order_reconcile_enabled": true,
    "cancel_orphan_orders": true,
    "cancel_side_mismatch_orders": true,
    "cancel_unknown_symbol_orders": true,
    "download_endpoints": {
      "spot": [
        "https://api.binance.com",
        "https://api1.binance.com",
        "https://api2.binance.com",
        "https://api3.binance.com",
        "https://api4.binance.com",
        "https://api.binance.me"
      ],
      "futures": [
        "https://fapi.binance.com",
        "https://fapi1.binance.com",
        "https://fapi2.binance.com",
        "https://fapi3.binance.com"
      ]
    },
    "params": {
      "direction": "BOTH",
      "leverage": 10,
      "add_margin": 4.2,
      "add_step_pct": 0.012,
      "max_positions": 3,
      "max_positions_range": 3,
      "max_positions_trend": 4,
      "bear_market_mode": false,
      "max_long_positions": 3,
      "max_short_positions": 3,
      "max_consecutive_losses": 3,
      "use_exchange_tz": false,
      "tz_offset_hours": 0,
      "day_open_tz": "Asia/Tokyo",
      "day_open_grace_seconds": 300,
      "take_profit_pct": 0.02,
      "max_dca": 0,
      "dca_enabled": false,
      "engine_mode": {
        "RANGE": {
          "max_dca_cap": 0.0
        },
        "TREND": {
          "max_dca_cap": 0.0
        }
      },
      "max_orders": 5,
      "consecutive_loss_cooldown_seconds": 1800,
      "daily_loss_cooldown_seconds": 28800,
      "daily_cooldown_pct": 0.08,
      "add_price_multiplier": 1.0,
      "add_amount_multiplier": 1.12,
      "max_hold_days": 2.0,
      "min_daily_volume_usdt": 100000,
      "min_15m_vol_ratio": 20,
      "min_price_change_pct": 0.8,
      "top_n_selection": 8,
      "top_n_per_side": 6,
      "symbol_stop_loss_pct": 0.012,
      "break_even_trigger_pct": 0.006,
      "trailing_stop_trigger_pct": 0.012,
      "trailing_stop_pct": 0.006,
      "profit_reinvest_pct": 100,
      "total_stop_loss_pct": 0.25,
      "total_stop_loss_cooldown_seconds": 14400,
      "execution_layer": {
        "enabled": true,
        "timeframe": "1m",
        "min_bars": 80,
        "allow_no_data_pass": true,
        "opposite_block_score": 2,
        "pullback_eps": 0.0015,
        "long_rsi_overbought": 65,
        "short_rsi_oversold": 35
      },
      "rsi_entry": 65,
      "rsi_entry_short": 65,
      "rsi_entry_long": 32,
      "td_add_count": 9,
      "score_threshold": 0.25,
      "score_threshold_short": 0.25,
      "score_threshold_long": 0.28,
      "min_p_win_threshold": 0.4,
      "min_p_win_short": 0.46,
      "min_p_win_long": 0.48,
      "bull_min_p_win_short": 0.46,
      "bear_min_p_win_long": 0.46,
      "bull_short_close_mult": 0.5,
      "bear_long_close_mult": 0.5,
      "combined_regime_enabled": true,
      "combined_regime_btc_weight": 0.7,
      "symbol_regime_enabled": true,
      "symbol_regime_timeframes": [
        "5m",
        "15m",
        "1h"
      ],
      "max_position_pct": 0.3,
      "max_position_pct_add": 0.65,
      "low_confidence_short_enabled": true,
      "high_score_candidate_n": 1,
      "low_score_candidate_n": 3,
      "allow_very_low_conf_short": false,
      "very_low_short_conf_max": 0.1,
      "cancel_untriggered_exit_orphans": true,
      "low_confidence_floor": 0.2,
      "low_confidence_candidate_slots": 1,
      "min_score_long": 0.1,
      "max_score_short": 0.005,
      "round_trip_fee_pct": 0.0008,
      "round_trip_slippage_pct": 0.0006,
      "funding_rate_estimate": 0.0001,
      "edge_funding_cycles": 3.0,
      "edge_funding_abs_cost": true,
      "edge_cost_ref_pct": 0.002,
      "edge_loss_realization": 0.45,
      "dynamic_threshold_a": 0.015,
      "dynamic_threshold_b": 0.02,
      "dynamic_threshold_c": 0.01,
      "dynamic_threshold_band": 0.08,
      "dynamic_threshold_vol_ref": 0.03,
      "dynamic_threshold_vol_scale": 0.015,
      "dynamic_threshold_trend_ref": 0.004,
      "score_exit_multiplier": 0.8,
      "trend_filter_enabled": true,
      "trend_ema_fast": 20,
      "trend_ema_slow": 50,
      "dca_disable_live_filter": false,
      "live_min_daily_volume_usdt": 100000,
      "btc_regime_enabled": true,
      "btc_regime_timeframes": [
        "1m",
        "3m",
        "5m",
        "15m",
        "1h",
        "4h"
      ],
      "btc_regime_update_seconds": 60,
      "major_regime_min_interval_seconds": 3600,
      "major_regime_confirm_count": 2,
      "bull_max_long": 4,
      "bull_max_short": 0,
      "bear_max_long": 0,
      "bear_max_short": 4,
      "neutral_max_long": 3,
      "neutral_max_short": 3,
      "bull_strong_max_long": 4,
      "bull_weak_max_long": 2,
      "bear_strong_max_short": 4,
      "bear_weak_max_short": 2,
      "weak_trend_direction_lock": true,
      "risk_mult": {
        "BULL_STRONG": 1.0,
        "BULL_WEAK": 0.8,
        "BEAR_STRONG": 1.0,
        "BEAR_WEAK": 0.8,
        "RANGE": 0.5,
        "RANGE_LOCK": 0.35
      },
      "regime_open_threshold": {
        "BULL_STRONG": {
          "min_ts_asset": 0.3,
          "min_vol_ratio": 1.3,
          "min_p_win": 0.45
        },
        "BULL_WEAK": {
          "min_ts_asset": 0.45,
          "min_vol_ratio": 1.4,
          "min_p_win": 0.48
        },
        "BEAR_STRONG": {
          "min_ts_asset": -0.3,
          "min_vol_ratio": 1.3,
          "min_p_win": 0.45
        },
        "BEAR_WEAK": {
          "min_ts_asset": -0.45,
          "min_vol_ratio": 1.4,
          "min_p_win": 0.48
        },
        "RANGE": {
          "min_ts_asset": 0.0,
          "min_vol_ratio": 1.5,
          "min_p_win": 0.46
        },
        "RANGE_LOCK": {
          "min_ts_asset": 0.0,
          "min_vol_ratio": 2.0,
          "min_p_win": 0.55
        }
      },
      "regime_position_transition_grace_bars": 3,
      "trend_scoring_enabled": true,
      "trend_score_weights": {
        "macro": 0.45,
        "market": 0.25,
        "asset": 0.3
      },
      "macro_weights": {
        "btc_4h": 0.65,
        "btc_1h": 0.35
      },
      "btc_4h_factors": {
        "ma_slope": 0.4,
        "bb_position": 0.3,
        "adx_filter": 0.3
      },
      "btc_1h_factors": {
        "structure_break": 0.6,
        "volume_confirm": 0.4
      },
      "market_factors": {
        "breadth": 0.7,
        "dispersion": 0.3
      },
      "asset_factors": {
        "30m": 0.7,
        "15m": 0.3
      },
      "asset_30m_factors": {
        "relative_strength": 0.4,
        "trend_structure": 0.3,
        "bb_breakout": 0.3
      },
      "asset_15m_factors": {
        "pullback_confirm": 0.7,
        "volatility_filter": 0.3
      },
      "regime_thresholds": {
        "strong_bull": 0.65,
        "weak_bull": 0.3,
        "neutral_upper": 0.3,
        "neutral_lower": -0.3,
        "weak_bear": -0.3,
        "strong_bear": -0.65
      },
      "transition_confirm": {
        "volume_ratio_min": 1.5,
        "adx_min": 20,
        "structure_break_required": true
      },
      "oscillation_detection": {
        "atr_decline_threshold": 0.1,
        "bb_width_threshold": 0.05,
        "adx_threshold": 25
      },
      "position_sizing": {
        "risk_per_trade_pct": 0.015,
        "atr_stop_multiplier": 2.0,
        "meme_stop_multiplier": 3.0,
        "meme_risk_mult": 0.8
      },
      "oscillation_mode": {
        "position_ratio": 0.5,
        "max_long": 3,
        "max_short": 3,
        "entry": {
          "timeframe": "15m",
          "rsi_low": 30,
          "rsi_high": 70,
          "bb_touch": 1.0,
          "vol_q_max": 0.65,
          "min_conf": 0.6,
          "mid_band": 0.002
        }
      },
      "regime_state_machine": {
        "enabled": true,
        "T_ENTER": 0.35,
        "T_EXIT": 0.15,
        "T_RANGE": 0.2,
        "T_STRONG": 0.65,
        "T_STRONG_EXIT": 0.55,
        "CONFIRM_BARS": 3,
        "V_CONFIRM": 1.5,
        "COOLDOWN_SEC": 1200,
        "FLIP_LIMIT": 2,
        "FLIP_WINDOW_SEC": 3600,
        "RANGE_LOCK_SEC": 5400,
        "BOS_PIVOT_L": 2,
        "BOS_ATR_K": 0.15,
        "BOS_VALID_WINDOW_SEC": 3600
      },
      "params_notes": {
        "strategy.mode": "\"DUAL_ENGINE\" 表示双引擎（震荡套利 + 趋势跟随），兼容旧值 DCA_ROTATION。",
        "strategy.dca_enabled": "建议固定 false；双引擎模式下不做DCA加仓。",
        "params.dca_enabled": "建议固定 false；与 strategy.dca_enabled 一起作为运行期禁用DCA的显式开关。",
        "params.max_dca": "建议固定 0；彻底关闭加仓补仓逻辑。",
        "params.trend_filter_enabled": "建议 true；趋势引擎必须启用趋势过滤。",
        "dca_disable_live_filter": "(bool) 实盘时若为 true 则跳过所有细粒度筛选，直接使用配置的 symbols 列表。默认 false。",
        "live_min_daily_volume_usdt": "(number) 实盘模式下的最小24h成交额阈值（USDT），仅在未禁用细筛时生效。可用于防止极小币种进入候选。默认 100000 (100k USDT)。",
        "max_long_positions": "(int) 同时持有的多单上限（仅开仓时生效）。根据牛熊状态动态调整。",
        "max_short_positions": "(int) 同时持有的空单上限（仅开仓时生效）。根据牛熊状态动态调整。",
        "btc_regime_enabled": "(bool) 是否启用基于BTC多时间周期的牛熊判断。",
        "btc_regime_timeframes": "(list) 用于判断牛熊的BTC K线周期列表。",
        "btc_regime_update_seconds": "(int) 牛熊判断更新间隔（秒），默认60秒。",
        "bull_max_long": "(int) 牛市时多单上限。",
        "bull_max_short": "(int) 牛市时空单上限。",
        "bear_max_long": "(int) 熊市时多单上限。",
        "bear_max_short": "(int) 熊市时空单上限。",
        "neutral_max_long": "(int) 震荡期多单上限。",
        "neutral_max_short": "(int) 震荡期空单上限。",
        "regime_position_transition_grace_bars": "(int) 牛熊转换时的缓冲周期数，避免频繁调仓。",
        "min_p_win_threshold": "(float) 最小开仓胜率阈值，低于此值不开仓。默认0.40。",
        "bull_short_close_mult": "(float) 牛市时空单平仓阈值乘数，<1表示更容易平仓。默认0.65。",
        "bear_long_close_mult": "(float) 熊市时多单平仓阈值乘数，<1表示更容易平仓。默认0.65。",
        "combined_regime_enabled": "(bool) 是否启用综合牛熊判断（BTC+交易对自身）。默认true。",
        "combined_regime_btc_weight": "(float) BTC权重，交易对自身权重=1-BTC权重。默认0.55。",
        "symbol_regime_enabled": "(bool) 是否启用交易对自身趋势判断。默认true。",
        "symbol_regime_timeframes": "(list) 交易对自身趋势判断的时间周期。默认[5m,15m,1h]。"
      },
      "bull_long_threshold_mult": 0.85,
      "bear_long_threshold_mult": 1.3,
      "bull_short_threshold_mult": 1.5,
      "bear_short_threshold_mult": 0.85
    }
  },
  "execution": {
    "rollback_on_tp_sl_fail": true
  },
  "network": {
    "profile": "vps_jp",
    "force_direct": true,
    "disable_proxy": true,
    "proxy_fallback": false,
    "close_use_proxy": false,
    "futures_endpoints": [
      "https://fapi.binance.com",
      "https://fapi1.binance.com",
      "https://fapi2.binance.com",
      "https://fapi3.binance.com"
    ]
  }
}
